<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>twellik: vector db for browser</title>
  </head>
  <style>
    html { background: #112; }
  </style>
  <body>
    <script type="module">
      import init, { create_collection, upsert_points, scroll_points } from "./twellik.js";

      const getAnimals = async () => {
          let response = await fetch("/animals.json")
          return await response.json()
      }

      init().then( async () => {
          let coll = "test_collection"
          create_collection(coll)

          let points = await getAnimals()
          console.log(points)
          upsert_points(coll, points)

          const wolfEmbedsCLIP = [0.005035386420786381, -0.024185415357351303, 0.012890570797026157, 0.008404320105910301, -0.013836014084517956, 0.014309247955679893, -0.04137912392616272, -0.11529096215963364, -0.03635075315833092, 0.035135526210069656, -0.025735734030604362, -0.021755225956439972, -0.005869176704436541, -0.012919289991259575, 0.012627687305212021, 0.018300332129001617, 0.03984219208359718, 0.00043147592805325985, -0.006312656681984663, -0.01548316515982151, 0.05467292293906212, 0.02219749614596367, 0.026442741975188255, 0.0020773422438651323, -0.006255680695176125, 0.0055421800352633, 0.003542343620210886, 0.0095982039347291, -0.034732431173324585, 0.010976061224937439, 0.03640110790729523, -0.014531221240758896, 0.010575384832918644, 0.006409873254597187, 0.026831796392798424, -0.009233946911990643, -0.011676628142595291, -0.0013535114703699946, -0.01532561145722866, 0.01321287639439106, -0.04152490943670273, 0.009156410582363605, 0.028171511366963387, -0.023853445425629616, 0.008592139929533005, 0.026612181216478348, 0.0008696923614479601, -0.0008163481252267957, -0.025071296840906143, -0.02164279669523239, 0.026650985702872276, 0.002059664111584425, 0.022354893386363983, -0.019312214106321335, -0.015508780255913734, -0.03547714650630951, 0.011132820509374142, 0.010092288255691528, -0.012890231795608997, 0.015535218641161919, 0.02920784056186676, -0.03194476291537285, 0.001081411843188107, 0.015854177996516228, 0.0075960466638207436, -0.0014004529220983386, -0.022170450538396835, -0.015207646414637566, -0.0009802262065932155, -0.00581530574709177, 0.04704314097762108, 0.006378877442330122, 0.003083284944295883, 0.013793786987662315, -0.03449322283267975, -0.014072363264858723, -0.019457025453448296, 0.008013936690986156, 0.0011853001778945327, -0.022272732108831406, -0.007563668303191662, 0.01428736001253128, -0.008347773924469948, 0.03697706013917923, 0.014357798732817173, -0.010294289328157902, 0.002023248700425029, -0.009088484570384026, 0.02587895840406418, -0.014435972087085247, -0.02746833860874176, 0.017336519435048103, -0.14207828044891357, 0.040592145174741745, 0.014435737393796444, -0.00632517272606492, -0.004926904570311308, -0.009144825860857964, 0.0031717896927148104, 0.007936494424939156, 0.023171888664364815, 0.02908000536262989, 0.01648135855793953, 0.01034639310091734, -0.02918117307126522, -0.0007516505429521203, 0.004990539979189634, 0.021592093631625175, 0.007935881614685059, 0.02345474436879158, 0.0095090726390481, 0.00016929606499616057, 0.00019467964011710137, -0.011884437873959541, -0.036534179002046585, -0.005799042526632547, -0.016264203935861588, 0.02447153814136982, 0.006128981243818998, -0.0031257369555532932, 0.02453790418803692, -0.07883007824420929, 0.006880112458020449, -0.01611909084022045, 0.004015272483229637, -0.022973597049713135, -0.02639825828373432, -0.0026864702813327312, 0.049426693469285965, 0.05423915758728981, 0.015584470704197884, -0.0414842888712883, 0.005852960515767336, 0.5831658840179443, -0.008070820942521095, -0.04657446965575218, -0.03333970159292221, -0.021948935464024544, 0.01938267983496189, -0.021310703828930855, 0.01870097778737545, -0.006470862776041031, -0.015334845520555973, 0.012857886962592602, -0.04428275302052498, 0.013828487135469913, 0.01248469203710556, -0.013603469356894493, -0.03220575675368309, -0.011495438404381275, 0.026055868715047836, -0.030362118035554886, -0.02052932418882847, 0.017988471314311028, -0.015196213498711586, -0.032624777406454086, 0.030397122725844383, -0.007153447717428207, 0.00948870088905096, 0.0053293402306735516, -0.0036912383511662483, 0.010619771666824818, -0.004252564627677202, -0.0017284841742366552, 0.011958696879446507, 0.0015700500225648284, 0.013673507608473301, 0.0008182005840353668, 0.0025444687344133854, 0.03017137385904789, -0.0011820803629234433, -0.010995388962328434, -0.004892868455499411, -0.0006721565150655806, -0.04973375424742699, -0.023853909224271774, -0.032221708446741104, 0.007369393948465586, -0.007976367138326168, -0.014034074731171131, 0.03360617905855179, 0.00047843967331573367, -0.02462638169527054, 0.0027278217021375895, -0.012897467240691185, 0.015587291680276394, 0.012512492947280407, -0.010516826063394547, -0.005495889578014612, -0.025709809735417366, -0.026733852922916412, 0.001767005305737257, -0.001268676365725696, -0.00886145606637001, -0.021597662940621376, 0.0053709945641458035, -0.03164605796337128, 0.024933768436312675, -0.002997400239109993, -0.019042951986193657, 0.0027638315223157406, -0.014916716143488884, 0.014229907654225826, 0.00016739634156692773, -0.015587177127599716, 0.030450761318206787, -0.0028329049237072468, -0.027628080919384956, -0.01162769552320242, -0.019036203622817993, 0.039815835654735565, 0.03873177617788315, 0.01834525726735592, -0.00040288359741680324, -0.0211508646607399, 0.004098790697753429, 0.003930162638425827, 0.022875521332025528, 0.028896965086460114, 0.0018532297108322382, -0.025404291227459908, -0.015369090251624584, -0.009760267101228237, -0.021032676100730896, 0.024285651743412018, -0.0076290820725262165, 0.017646802589297295, 0.009257679805159569, -0.009671278297901154, -0.011146431788802147, -0.0037292891647666693, 0.015571353957057, 0.04036998748779297, 0.031957417726516724, 0.052240025252103806, 0.02332988567650318, 0.005622521508485079, -0.011526824906468391, -0.02678350731730461, -0.04126632958650589, 0.018386026844382286, 0.04079547896981239, 0.026436995714902878, 0.0013463683426380157, -0.007794794160872698, -0.0231365654617548, -0.03758286312222481, -0.04163901135325432, -0.01320457924157381, 0.015555990859866142, -0.025024134665727615, 0.02556605264544487, 0.00018202062346972525, 0.06536097079515457, 0.026717275381088257, 0.025280766189098358, -0.022272281348705292, 0.0018258481286466122, -0.009546882472932339, 0.026156922802329063, 0.030961787328124046, -0.005726759321987629, -0.0067128525115549564, -0.03671295940876007, -0.026220494881272316, -0.003536825068295002, 0.01262359693646431, -0.03796519711613655, -0.02061140164732933, 0.03965248912572861, 0.006600444670766592, -0.008167717605829239, 0.0208754763007164, 0.023797573521733284, 0.025257939472794533, 0.003293657675385475, 0.016449514776468277, 0.007027423940598965, -0.011317092925310135, 0.027897272258996964, -0.015967857092618942, 0.007501268293708563, 0.014944840222597122, 0.016960719600319862, 0.01878083497285843, 0.03152747079730034, -0.0018745948327705264, 0.02030196413397789, 0.007319717667996883, -0.022264719009399414, -0.019628847017884254, 0.014542201533913612, -0.014778531156480312, -0.01113753393292427, -0.05617063120007515, -0.0049509466625750065, -0.02971482090651989, 0.009808742441236973, -0.0012005879543721676, -0.021719157695770264, 0.004282696638256311, 0.015261082910001278, 0.0013643259881064296, 0.00900136586278677, -0.012963353656232357, -0.030531534925103188, -0.02365645207464695, -0.00720136146992445, 0.020979007706046104, -0.012694086879491806, 0.03532664105296135, 0.01696251519024372, 0.5824242234230042, 0.035972755402326584, 0.0020885923877358437, 0.012714807875454426, 0.013869551941752434, 0.024966955184936523, 0.0167195126414299, -0.012200666591525078, 0.043403808027505875, 0.028027044609189034, 0.022747106850147247, 0.014729316346347332, 0.03807181492447853, 0.0047059934586286545, -0.010666674003005028, -0.023745471611618996, 0.027187827974557877, -0.20041853189468384, -0.008706845343112946, 0.03457975760102272, 0.03149198368191719, -0.0025794943794608116, 0.018465526401996613, 0.00013330810179468244, 0.04297961667180061, 0.015724604949355125, 0.0061217062175273895, -0.015806222334504128, -0.011824622750282288, 0.0044738855212926865, -0.006442244630306959, -0.020699774846434593, -0.009345843456685543, -0.003610959043726325, -0.004305398091673851, 0.037442389875650406, -0.042457759380340576, 0.012445086613297462, 0.01657363772392273, -0.017831193283200264, 0.010649499483406544, 0.017449453473091125, -0.004240263719111681, 0.03572602570056915, 0.006497485097497702, -0.020270399749279022, 0.007194583769887686, -0.0007397188455797732, 0.035470910370349884, -0.029042895883321762, -0.011941999197006226, 0.012236043810844421, 0.030007395893335342, -0.027897512540221214, 0.01861019805073738, -0.0039161741733551025, 0.01349154207855463, -0.006880161352455616, -0.03196047618985176, 0.005868836306035519, -0.016085049137473106, 0.008653613738715649, 0.0012590087717399001, 0.006572439335286617, -0.027525771409273148, -0.01331532746553421, -0.023289140313863754, 0.017479553818702698, -0.03199660778045654, -0.009812752716243267, -0.00032614771043881774, -0.04724259674549103, 0.01361737959086895, -0.028761016204953194, -0.011522186920046806, 0.020555313676595688, 0.007781177293509245, -0.002647600369527936, -0.024943888187408447, -0.0034056552685797215, -0.029032330960035324, -0.018266310915350914, 0.025218576192855835, 0.017330974340438843, -0.01692637987434864, 0.013744315132498741, -0.027230016887187958, 0.05886203423142433, -0.0007556676864624023, -0.013332663103938103, 0.029670827090740204, 0.013377967290580273, -0.010166039690375328, 0.00812462903559208, 0.007091603707522154, -0.025335945188999176, 0.04499635845422745, -0.019946211948990822, 0.04406308755278587, -0.0018341256072744727, 0.0016756830736994743, 0.043856341391801834, 0.011267530731856823, 0.023783311247825623, 0.015586034394800663, -0.026188965886831284, 0.03142766281962395, 0.0028754370287060738, 0.016457192599773407, -0.027963800355792046, -0.00764693645760417, -0.014473624527454376, 0.01599031314253807, -0.0015135518042370677, -0.003609327133744955, 0.007722154725342989, 0.020916618406772614, 0.024135323241353035, 0.014758397825062275, -0.00629405165091157, -0.004029220901429653, 0.02296183444559574, 0.0008767818799242377, 0.04377220198512077, -0.03303144872188568, -0.028609763830900192, -0.05450320243835449, 0.014268498867750168, 0.00426750723272562, 0.02208792231976986, -0.010729070752859116, -0.015537911094725132, 0.0023474032059311867, 0.011741669848561287, -0.03320184722542763, -0.011383580975234509, 0.038943398743867874, 0.00036658169119618833, -0.009726502001285553, 0.011258813552558422, 0.009676847606897354, 0.010040709748864174, 0.01701112650334835, -0.012501868419349194, 0.030018877238035202, 0.025480154901742935, 0.023382864892482758, -0.030380675569176674, 0.01688462495803833, -3.0976450943853706e-05, 0.007608459796756506, 0.024372275918722153, 0.02571903169155121, 0.008875712752342224, 0.006515789311379194, -0.022046266123652458, -0.013663058169186115, 0.020345568656921387, 0.011041929945349693, -0.010132563300430775, 0.02563965879380703, -0.014473473653197289, -0.027428120374679565, 0.021495135501027107, 0.009250734001398087, 0.011459415778517723, 0.0232718326151371, 0.029674742370843887, -0.00014358264161273837, -0.05735626816749573, -0.003850107081234455, 0.01706273853778839, -0.0325426310300827, -0.017765264958143234, 0.0034792812075465918, -0.006744856014847755, 0.01849202811717987, 4.9560938350623474e-05, -0.04058266803622246, -0.004810239188373089, 0.015254709869623184, 0.07850711047649384, 0.02530505508184433, 0.0015072178794071078, 0.014157610945403576, 0.018893631175160408, 0.00642332574352622, 0.009882748126983643, 0.020227674394845963, -0.012040696106851101, 0.02976059913635254, 0.05037450045347214, -0.005416602361947298, -0.010744545608758926, -0.04085804894566536, -0.007110218051820993, -0.0003092234837822616, -0.031843822449445724, -0.0377565398812294, 0.03209229186177254]

          let query = {
              vector: wolfEmbedsCLIP,
              payload: {},
              k: 4
          }

          let searchRes = scroll_points(coll, query)
          searchRes.forEach( res => {
              console.log(res.distance, res.point.payload)
          })


     });
    </script>
  </body>
</html>
